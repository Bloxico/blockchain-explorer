version: 0.2
phases: 
  install:
    run-as: root
    runtime-versions:
        docker: 18    
    commands: 
      - whoami
      - $(aws ecr get-login --region $REGION  --no-include-email)
  build: 
    commands: 
    - echo Build started on `date` 
    - echo Building the Docker image... 
    # update the following line with the name of your own ECR repository
    - docker build -t $REPOSITORY_URI:$ENVIRONMENT .

  post_build: 
    commands: 
    - echo Build completed on `date` 
    - echo pushing to repo
    # # update the following line with the URI of your own ECR repository
    - docker push $REPOSITORY_URI:$ENVIRONMENT
